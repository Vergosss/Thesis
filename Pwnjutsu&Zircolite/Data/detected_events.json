[{
  "title": "System and Hardware Information Discovery",
  "id": "1f358e2e-cb63-43c3-b575-dfb072a6814f",
  "description": "Detects system information discovery commands",
  "sigmafile": "lnx_auditd_system_info_discovery2.yml",
  "sigma": [
    "SELECT * FROM logs WHERE (type = 'PATH' AND (name LIKE '/sys/class/dmi/id/bios\\_version' ESCAPE '\\' OR name LIKE '/sys/class/dmi/id/product\\_name' ESCAPE '\\' OR name LIKE '/sys/class/dmi/id/chassis\\_vendor' ESCAPE '\\' OR name LIKE '/proc/scsi/scsi' ESCAPE '\\' OR name LIKE '/proc/ide/hd0/model' ESCAPE '\\' OR name LIKE '/proc/version' ESCAPE '\\' OR name LIKE '/etc/%version' ESCAPE '\\' OR name LIKE '/etc/%release' ESCAPE '\\' OR name LIKE '/etc/issue' ESCAPE '\\'))"
  ],
  "rule_level": "informational",
  "tags": [
    "attack.discovery",
    "attack.t1082"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 66304,
      "type": "PATH",
      "timestamp": "2021-05-12 10:04:37",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "item": "0",
      "name": "/etc/issue",
      "inode": "524606",
      "dev": "fc:00",
      "mode": "0100644",
      "ouid": "0",
      "ogid": "0",
      "rdev": "00:00"
    }
  ]
},
{
  "title": "Suspicious C2 Activities",
  "id": "f7158a64-6204-4d6d-868a-6e6378b467e0",
  "description": "Detects suspicious activities as declared by Florian Roth in its 'Best Practice Auditd Configuration'.\nThis includes the detection of the following commands; wget, curl, base64, nc, netcat, ncat, ssh, socat, wireshark, rawshark, rdesktop, nmap.\nThese commands match a few techniques from the tactics \"Command and Control\", including not exhaustively the following; Application Layer Protocol (T1071), Non-Application Layer Protocol (T1095), Data Encoding (T1132)\n",
  "sigmafile": "lnx_auditd_susp_c2_commands.yml",
  "sigma": [
    "SELECT * FROM logs WHERE key LIKE 'susp\\_activity' ESCAPE '\\'"
  ],
  "rule_level": "medium",
  "tags": [
    "attack.command-and-control"
  ],
  "count": 18,
  "matches": [
    {
      "row_id": 67177,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67178,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67179,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67180,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67181,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67182,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67183,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67184,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67185,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67186,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67187,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67188,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67189,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67190,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67191,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67192,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67193,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    },
    {
      "row_id": 67194,
      "type": "CONFIG_CHANGE",
      "timestamp": "2021-05-12 10:04:33",
      "op": "add",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "auid": "4294967295",
      "ses": "4294967295",
      "key": "susp_activity",
      "res": "1,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "list": "4"
    }
  ]
},
{
  "title": "System Information Discovery - Auditd",
  "id": "f34047d9-20d3-4e8b-8672-0a35cc50dc71",
  "description": "Detects System Information Discovery commands",
  "sigmafile": "lnx_auditd_system_info_discovery.yml",
  "sigma": [
    "SELECT * FROM logs WHERE ((type = 'PATH' AND name IN ('/etc/lsb-release', '/etc/redhat-release', '/etc/issue')) OR (type = 'EXECVE' AND a0 IN ('uname', 'uptime', 'lsmod', 'hostname', 'env')) OR (type = 'EXECVE' AND a0 = 'grep' AND (a1 LIKE '%vbox%' ESCAPE '\\' OR a1 LIKE '%vm%' ESCAPE '\\' OR a1 LIKE '%xen%' ESCAPE '\\' OR a1 LIKE '%virtio%' ESCAPE '\\' OR a1 LIKE '%hv%' ESCAPE '\\')) OR (type = 'EXECVE' AND a0 = 'kmod' AND a1 = 'list'))"
  ],
  "rule_level": "low",
  "tags": [
    "attack.discovery",
    "attack.t1082"
  ],
  "count": 28,
  "matches": [
    {
      "row_id": 237,
      "type": "EXECVE",
      "timestamp": "2021-05-13 16:27:34",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "env",
      "a1": "LC_ALL",
      "a2": "unattended-upgrade",
      "a3": "--help,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "4"
    },
    {
      "row_id": 23090,
      "type": "EXECVE",
      "timestamp": "2021-05-13 09:24:43",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-r,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "2"
    },
    {
      "row_id": 30256,
      "type": "EXECVE",
      "timestamp": "2021-05-13 05:03:35",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-p,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "2"
    },
    {
      "row_id": 30277,
      "type": "EXECVE",
      "timestamp": "2021-05-13 05:03:34",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-m,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "2"
    },
    {
      "row_id": 30280,
      "type": "EXECVE",
      "timestamp": "2021-05-13 05:03:34",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-m,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "2"
    },
    {
      "row_id": 30283,
      "type": "EXECVE",
      "timestamp": "2021-05-13 05:03:34",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-r,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "2"
    },
    {
      "row_id": 30286,
      "type": "EXECVE",
      "timestamp": "2021-05-13 05:03:34",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-o,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "2"
    },
    {
      "row_id": 31430,
      "type": "EXECVE",
      "timestamp": "2021-05-13 04:18:43",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-r,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "2"
    },
    {
      "row_id": 31605,
      "type": "EXECVE",
      "timestamp": "2021-05-13 04:18:42",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "env",
      "a1": "LC_ALL",
      "a2": "unattended-upgrade",
      "a3": "--help,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "4"
    },
    {
      "row_id": 36843,
      "type": "EXECVE",
      "timestamp": "2021-05-13 01:09:40",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-p,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 36873,
      "type": "EXECVE",
      "timestamp": "2021-05-13 01:09:40",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-m,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 36878,
      "type": "EXECVE",
      "timestamp": "2021-05-13 01:09:40",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-m,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 36883,
      "type": "EXECVE",
      "timestamp": "2021-05-13 01:09:40",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-r,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 36888,
      "type": "EXECVE",
      "timestamp": "2021-05-13 01:09:40",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-o,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 44911,
      "type": "EXECVE",
      "timestamp": "2021-05-12 20:05:24",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-r,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 45086,
      "type": "EXECVE",
      "timestamp": "2021-05-12 20:05:23",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "env",
      "a1": "LC_ALL",
      "a2": "unattended-upgrade",
      "a3": "--help,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "4"
    },
    {
      "row_id": 58756,
      "type": "EXECVE",
      "timestamp": "2021-05-12 11:11:45",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-p,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 58786,
      "type": "EXECVE",
      "timestamp": "2021-05-12 11:11:45",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-m,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 58791,
      "type": "EXECVE",
      "timestamp": "2021-05-12 11:11:45",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-m,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 58796,
      "type": "EXECVE",
      "timestamp": "2021-05-12 11:11:45",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-r,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 58801,
      "type": "EXECVE",
      "timestamp": "2021-05-12 11:11:45",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-o,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 64577,
      "type": "EXECVE",
      "timestamp": "2021-05-12 10:53:35",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-r,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 66039,
      "type": "EXECVE",
      "timestamp": "2021-05-12 10:11:48",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-p,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 66304,
      "type": "PATH",
      "timestamp": "2021-05-12 10:04:37",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "item": "0",
      "name": "/etc/issue",
      "inode": "524606",
      "dev": "fc:00",
      "mode": "0100644",
      "ouid": "0",
      "ogid": "0",
      "rdev": "00:00"
    },
    {
      "row_id": 66469,
      "type": "EXECVE",
      "timestamp": "2021-05-12 10:04:35",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "env",
      "a1": "-i",
      "a2": "LANG",
      "a3": "PATH",
      "argc": "6",
      "a4": "apache2ctl",
      "a5": "start,linux_audit,/var/log/audit/audit.log,2021-05-12"
    },
    {
      "row_id": 66540,
      "type": "EXECVE",
      "timestamp": "2021-05-12 10:04:35",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "env",
      "a1": "-i",
      "a2": "LANG",
      "a3": "PATH",
      "argc": "6",
      "a4": "apache2ctl",
      "a5": "configtest,linux_audit,/var/log/audit/audit.log,2021-05-12"
    },
    {
      "row_id": 66599,
      "type": "EXECVE",
      "timestamp": "2021-05-12 10:04:34",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-p,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    },
    {
      "row_id": 66611,
      "type": "EXECVE",
      "timestamp": "2021-05-12 10:04:34",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "uname",
      "a1": "-s,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "2"
    }
  ]
},
{
  "title": "File or Folder Permissions Change",
  "id": "74c01ace-0152-4094-8ae2-6fd776dd43e5",
  "description": "Detects file and folder permission changes.",
  "sigmafile": "lnx_auditd_file_or_folder_permissions.yml",
  "sigma": [
    "SELECT * FROM logs WHERE (type = 'EXECVE' AND (a0 LIKE '%chmod%' ESCAPE '\\' OR a0 LIKE '%chown%' ESCAPE '\\'))"
  ],
  "rule_level": "low",
  "tags": [
    "attack.defense-evasion",
    "attack.t1222.002"
  ],
  "count": 9,
  "matches": [
    {
      "row_id": 12096,
      "type": "EXECVE",
      "timestamp": "2021-05-13 13:32:48",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "chmod",
      "a1": "+x",
      "a2": "/tmp/FWbsz,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "3"
    },
    {
      "row_id": 12190,
      "type": "EXECVE",
      "timestamp": "2021-05-13 13:29:55",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "chmod",
      "a1": "+x",
      "a2": "/tmp/iOpRS,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "3"
    },
    {
      "row_id": 20329,
      "type": "EXECVE",
      "timestamp": "2021-05-13 09:42:17",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "chmod",
      "a1": "600",
      "a2": "gshadow.bak,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "3"
    },
    {
      "row_id": 20345,
      "type": "EXECVE",
      "timestamp": "2021-05-13 09:42:17",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "chmod",
      "a1": "600",
      "a2": "shadow.bak,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "3"
    },
    {
      "row_id": 20361,
      "type": "EXECVE",
      "timestamp": "2021-05-13 09:42:17",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "chmod",
      "a1": "600",
      "a2": "group.bak,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "3"
    },
    {
      "row_id": 20373,
      "type": "EXECVE",
      "timestamp": "2021-05-13 09:42:17",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "chmod",
      "a1": "600",
      "a2": "passwd.bak,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "3"
    },
    {
      "row_id": 21824,
      "type": "EXECVE",
      "timestamp": "2021-05-13 09:41:40",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "chmod",
      "a1": "700",
      "a2": "/tmp/tmp.nXkpmv14Dd,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "argc": "3"
    },
    {
      "row_id": 66507,
      "type": "EXECVE",
      "timestamp": "2021-05-12 10:04:35",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "chown",
      "a1": "www-data",
      "a2": "/var/lock/apache2.NC9WqjH1vv,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "3"
    },
    {
      "row_id": 66511,
      "type": "EXECVE",
      "timestamp": "2021-05-12 10:04:35",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "chmod",
      "a1": "755",
      "a2": "/var/lock/apache2.NC9WqjH1vv,linux_audit,/var/log/audit/audit.log,2021-05-12",
      "argc": "3"
    }
  ]
},
{
  "title": "Data Compressed",
  "id": "a3b5e3e9-1b49-4119-8b8e-0344a01f21ee",
  "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.",
  "sigmafile": "lnx_auditd_data_compressed.yml",
  "sigma": [
    "SELECT * FROM logs WHERE ((type = 'execve' AND a0 = 'zip') OR (type = 'execve' AND a0 = 'gzip' AND a1 = '-k') OR (type = 'execve' AND a0 = 'tar' AND a1 LIKE '%-c%' ESCAPE '\\'))"
  ],
  "rule_level": "low",
  "tags": [
    "attack.exfiltration",
    "attack.t1560.001"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 22508,
      "type": "EXECVE",
      "timestamp": "2021-05-13 09:25:03",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "a0": "tar",
      "a1": "-cf",
      "a2": "alternatives.tar",
      "a3": "-C",
      "argc": "6",
      "a4": "/var/lib/dpkg",
      "a5": "alternatives,linux_audit,/var/log/audit/audit.log,2021-05-13"
    }
  ]
},
{
  "title": "Use Of Hidden Paths Or Files",
  "id": "9e1bef8d-0fff-46f6-8465-9aa54e128c1e",
  "description": "Detects calls to hidden files or files located in hidden directories in NIX systems.",
  "sigmafile": "lnx_auditd_hidden_binary_execution.yml",
  "sigma": [
    "SELECT * FROM logs WHERE ((type = 'PATH' AND name LIKE '%/.%' ESCAPE '\\') AND NOT ((name LIKE '%/.cache/%' ESCAPE '\\' OR name LIKE '%/.config/%' ESCAPE '\\' OR name LIKE '%/.pyenv/%' ESCAPE '\\' OR name LIKE '%/.rustup/toolchains%' ESCAPE '\\')))"
  ],
  "rule_level": "low",
  "tags": [
    "attack.defense-evasion",
    "attack.t1574.001"
  ],
  "count": 4,
  "matches": [
    {
      "row_id": 4213,
      "type": "PATH",
      "timestamp": "2021-05-13 14:15:51",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "item": "1",
      "name": "/root/.ssh/known_hosts",
      "inode": "1714933",
      "dev": "fc:00",
      "mode": "0100644",
      "ouid": "0",
      "ogid": "0",
      "rdev": "00:00"
    },
    {
      "row_id": 4214,
      "type": "PATH",
      "timestamp": "2021-05-13 14:15:51",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "item": "0",
      "name": "/root/.ssh/",
      "inode": "1712179",
      "dev": "fc:00",
      "mode": "040700",
      "ouid": "0",
      "ogid": "0",
      "rdev": "00:00"
    },
    {
      "row_id": 4217,
      "type": "PATH",
      "timestamp": "2021-05-13 14:15:50",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "item": "1",
      "name": "/root/.ssh",
      "inode": "1712179",
      "dev": "fc:00",
      "mode": "040700",
      "ouid": "0",
      "ogid": "0",
      "rdev": "00:00"
    },
    {
      "row_id": 66594,
      "type": "PATH",
      "timestamp": "2021-05-12 10:04:34",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "item": "0",
      "name": "/opt/apache_continuum/apache-continuum-1.4.2/bin/./wrapper-linux-x86-64",
      "inode": "924701",
      "dev": "fc:00",
      "mode": "0100755",
      "ouid": "0",
      "ogid": "50",
      "rdev": "00:00"
    }
  ]
},
{
  "title": "Program Executions in Suspicious Folders",
  "id": "a39d7fa7-3fbd-4dc2-97e1-d87f546b1bbc",
  "description": "Detects program executions in suspicious non-program folders related to malware or hacking activity",
  "sigmafile": "lnx_auditd_susp_exe_folders.yml",
  "sigma": [
    "SELECT * FROM logs WHERE (type = 'SYSCALL' AND (exe LIKE '/tmp/%' ESCAPE '\\' OR exe LIKE '/var/www/%' ESCAPE '\\' OR exe LIKE '/home/%/public\\_html/%' ESCAPE '\\' OR exe LIKE '/usr/local/apache2/%' ESCAPE '\\' OR exe LIKE '/usr/local/httpd/%' ESCAPE '\\' OR exe LIKE '/var/apache/%' ESCAPE '\\' OR exe LIKE '/srv/www/%' ESCAPE '\\' OR exe LIKE '/home/httpd/html/%' ESCAPE '\\' OR exe LIKE '/srv/http/%' ESCAPE '\\' OR exe LIKE '/usr/share/nginx/html/%' ESCAPE '\\' OR exe LIKE '/var/lib/pgsql/data/%' ESCAPE '\\' OR exe LIKE '/usr/local/mysql/data/%' ESCAPE '\\' OR exe LIKE '/var/lib/mysql/%' ESCAPE '\\' OR exe LIKE '/var/vsftpd/%' ESCAPE '\\' OR exe LIKE '/etc/bind/%' ESCAPE '\\' OR exe LIKE '/var/named/%' ESCAPE '\\'))"
  ],
  "rule_level": "medium",
  "tags": [
    "attack.t1587",
    "attack.t1584",
    "attack.resource-development"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 12093,
      "type": "SYSCALL",
      "timestamp": "2021-05-13 13:32:48",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "arch": "c000003e",
      "syscall": "59",
      "success": "yes",
      "exit": "0",
      "a0": "7fd57f70d948",
      "a1": "7fd57f70d970",
      "a2": "7fd57f70da88",
      "a3": "7fff7f8a7e30",
      "items": "1",
      "ppid": "1896",
      "pid": "1902",
      "auid": "4294967295",
      "uid": "0",
      "gid": "0",
      "euid": "0",
      "suid": "0",
      "fsuid": "0",
      "egid": "0",
      "sgid": "0",
      "fsgid": "0",
      "tty": "(none)",
      "ses": "4294967295",
      "comm": "FWbsz",
      "exe": "/tmp/FWbsz",
      "key": "rootcmd,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "per": "400000"
    },
    {
      "row_id": 12187,
      "type": "SYSCALL",
      "timestamp": "2021-05-13 13:29:55",
      "host": "offline",
      "OriginalLogfile": "system_logs_audit.log-EXNDD24G.json",
      "arch": "c000003e",
      "syscall": "59",
      "success": "yes",
      "exit": "0",
      "a0": "7f6eb3f6a948",
      "a1": "7f6eb3f6a970",
      "a2": "7f6eb3f6aa88",
      "a3": "7fffcf8eed80",
      "items": "1",
      "ppid": "1884",
      "pid": "1890",
      "auid": "4294967295",
      "uid": "0",
      "gid": "0",
      "euid": "0",
      "suid": "0",
      "fsuid": "0",
      "egid": "0",
      "sgid": "0",
      "fsgid": "0",
      "tty": "(none)",
      "ses": "4294967295",
      "comm": "iOpRS",
      "exe": "/tmp/iOpRS",
      "key": "rootcmd,linux_audit,/var/log/audit/audit.log,2021-05-13",
      "per": "400000"
    }
  ]
}]